{"id":"st-1fl","title":"Record add/set/show","description":"Commands: add (with --set), set (single and --col multi), show (with --json, --with-files, --history). Basic CRUD operations.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:42.429567776Z","created_by":"dev","updated_at":"2026-01-08T20:45:27.501367097Z","closed_at":"2026-01-08T20:45:27.501367097Z","close_reason":"Closed","labels":["phase:2-core-cli"],"dependencies":[{"issue_id":"st-1fl","depends_on_id":"st-w3r","type":"blocks","created_at":"2026-01-08T19:42:37.925384149Z","created_by":"dev"}]}
{"id":"st-1n7","title":"List and filter","description":"Command: list with --where, --columns, --tree, --json, --deleted, --all flags. Tree rendering for hierarchy. Filter by SQL WHERE clause.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:52.023564355Z","created_by":"dev","updated_at":"2026-01-08T20:53:59.629168651Z","closed_at":"2026-01-08T20:53:59.629168651Z","close_reason":"Closed","labels":["phase:3-schema-query"],"dependencies":[{"issue_id":"st-1n7","depends_on_id":"st-1fl","type":"blocks","created_at":"2026-01-08T19:42:39.585866816Z","created_by":"dev"}]}
{"id":"st-3eq","title":"File attachments","description":"Command: file (with --content, --from). Create files/ directory. Store filename in column. Support --with-files in show command.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:03.093691456Z","created_by":"dev","updated_at":"2026-01-08T20:53:59.820474166Z","closed_at":"2026-01-08T20:53:59.820474166Z","close_reason":"Closed","labels":["phase:4-advanced-records"],"dependencies":[{"issue_id":"st-3eq","depends_on_id":"st-1fl","type":"blocks","created_at":"2026-01-08T19:42:47.621630035Z","created_by":"dev"}]}
{"id":"st-3um","title":"Core model types","description":"Record, Column, Stash structs with validation. ID generation (base36 4-char). SHA-256 hash calculation (first 12 chars). Prefix validation (3-5 chars). Case-insensitive column matching.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:31.16053809Z","created_by":"dev","updated_at":"2026-01-08T20:05:47.057319746Z","closed_at":"2026-01-08T20:05:47.057319746Z","close_reason":"Core model types complete: Record, Column, Stash structs, ID generation (base36), hash calculation (SHA-256 12-char), prefix validation, case-insensitive columns. All tests passing.","labels":["phase:1-foundation"],"dependencies":[{"issue_id":"st-3um","depends_on_id":"st-mir","type":"blocks","created_at":"2026-01-08T19:42:36.964938865Z","created_by":"dev"}]}
{"id":"st-4a4","title":"Test infrastructure","description":"Test helpers: runStash(), setupStash(), showRecord(). Test fixtures in tests/fixtures/. CI setup with GitHub Actions. Coverage reporting.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:37.480013741Z","created_by":"dev","updated_at":"2026-01-08T20:14:59.651721326Z","closed_at":"2026-01-08T20:14:59.651721326Z","close_reason":"Closed","labels":["phase:7-testing"],"dependencies":[{"issue_id":"st-4a4","depends_on_id":"st-mir","type":"blocks","created_at":"2026-01-08T19:42:57.971893835Z","created_by":"dev"}]}
{"id":"st-51f","title":"Import/Export","description":"Commands: import (CSV with --column, --confirm, --dry-run), export (with --format csv|json, --where, --include-deleted). Column detection from headers.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:15.644681436Z","created_by":"dev","updated_at":"2026-01-08T21:17:11.27234066Z","closed_at":"2026-01-08T21:17:11.27234066Z","close_reason":"Closed","labels":["phase:5-integration"],"dependencies":[{"issue_id":"st-51f","depends_on_id":"st-tne","type":"blocks","created_at":"2026-01-08T19:42:49.091955943Z","created_by":"dev"},{"issue_id":"st-51f","depends_on_id":"st-1n7","type":"blocks","created_at":"2026-01-08T19:42:49.147303072Z","created_by":"dev"}]}
{"id":"st-55k","title":"Soft delete workflow","description":"Commands: delete (with --cascade, --yes), restore (with --cascade), purge (with --before, --id, --all, --dry-run, --yes). Set _deleted_at/_deleted_by fields.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:01.052735051Z","created_by":"dev","updated_at":"2026-01-08T20:53:59.754083369Z","closed_at":"2026-01-08T20:53:59.754083369Z","close_reason":"Closed","labels":["phase:4-advanced-records"],"dependencies":[{"issue_id":"st-55k","depends_on_id":"st-1fl","type":"blocks","created_at":"2026-01-08T19:42:47.560895942Z","created_by":"dev"}]}
{"id":"st-5ad","title":"Handoff: Stash implementation - foundation phase complete","description":"## Goal\nImplement stash - a record-centric structured data store for AI agents (Go CLI).\n\n## What Was Done\n\n### Specs Reviewed \u0026 Enhanced\n- Created `usecases/` directory with YAML files (stash.yaml, records.yaml, columns.yaml, query.yaml, import.yaml, sync.yaml)\n- Created `usecases/SCHEMA.md` documenting UCDD format\n- Updated `CLAUDE.md` with development discipline section (UCDD workflow, drift review, test naming)\n\n### Beads Completed\n1. **st-mir**: Project scaffolding\n   - Go module: github.com/user/stash\n   - Directory structure: cmd/stash, internal/{cli,config,context,daemon,model,output,storage}, tests/\n   - Cobra root command with global flags: --json, --stash, --actor, --quiet, --verbose, --no-daemon\n   - Version command\n\n2. **st-3um**: Core model types\n   - `internal/model/errors.go` - All error types\n   - `internal/model/record.go` - Record struct with hash calculation (SHA-256, 12-char), JSON marshal/unmarshal\n   - `internal/model/column.go` - Column struct, case-insensitive matching, reserved name validation\n   - `internal/model/stash.go` - Stash struct, prefix validation (3-5 chars)\n   - `internal/model/id.go` - ID generation (base36 4-char), hierarchy helpers\n   - All tests passing (70+ tests)\n\n### Beads Created\n- **st-5yo**: Test infrastructure helpers (open)\n\n## What's Ready Next\n`bd ready` shows:\n1. **st-qhm**: Storage layer (JSONL + SQLite) - bigger, critical path\n2. **st-gvm**: Context detection (actor/branch resolution) - smaller\n3. **st-4a4**: Test infrastructure\n4. **st-5yo**: Test infrastructure helpers\n\n## Key Files\n```\ncmd/stash/main.go\ninternal/cli/root.go\ninternal/cli/version.go\ninternal/model/errors.go\ninternal/model/record.go + record_test.go\ninternal/model/column.go + column_test.go\ninternal/model/stash.go + stash_test.go\ninternal/model/id.go + id_test.go\nusecases/*.yaml\n```\n\n## Resume Command\n```bash\nbd ready                    # See unblocked work\nbd show qhm                 # Storage layer details\nbd show gvm                 # Context detection details\ngo test ./...               # Verify tests still pass\n./stash --help              # Verify CLI works\n```","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T20:07:38.411994079Z","created_by":"dev","updated_at":"2026-01-08T20:18:11.881899441Z","closed_at":"2026-01-08T20:18:11.881899441Z","close_reason":"Closed","labels":["handoff","main"]}
{"id":"st-5yo","title":"Test infrastructure helpers","description":"Create test helper functions for UCDD tests:\n\n- runStash(args...) - Execute stash CLI and capture stdout/stderr/exit\n- setupStash(t, name, prefix, flags...) - Create temporary stash for test\n- showRecord(t, id) - Parse record from stash show --json\n- readConfig(t, path) - Parse config.json\n- writeCSV(t, path, content) - Create test CSV file\n- parseJSON(content) - Parse JSON output to []map\n\nReference: specs/tests.md lines 989-1108","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:53:53.264280276Z","created_by":"dev","updated_at":"2026-01-08T20:14:59.715152596Z","closed_at":"2026-01-08T20:14:59.715152596Z","close_reason":"Closed"}
{"id":"st-6ul","title":"Sync command","description":"Command: sync with --rebuild, --flush, --status, --from-main. JSONL to SQLite synchronization. Full rebuild capability.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:16.569335516Z","created_by":"dev","updated_at":"2026-01-08T20:29:21.980242465Z","closed_at":"2026-01-08T20:29:21.980242465Z","close_reason":"Closed","labels":["phase:5-integration"],"dependencies":[{"issue_id":"st-6ul","depends_on_id":"st-qhm","type":"blocks","created_at":"2026-01-08T19:42:49.20490449Z","created_by":"dev"}]}
{"id":"st-7og","title":"CLAUDE.md onboarding snippet missing column setup step","description":"## Problem\n\nWhen Claude Code uses stash in a new project, it doesn't know that columns must be defined before adding records. This leads to the error:\n\n```\nError: cannot add record - stash has no columns defined\nHint: use `stash column add \u003cname\u003e` to add a column first\n```\n\nAlso, column naming constraints (no hyphens, must use underscores) aren't documented.\n\n## Expected\n\nThe CLAUDE.md onboarding snippet should include:\n1. Column setup step before adding records\n2. Column naming rules (letters, numbers, underscores only)\n3. Example workflow: init → columns → add records\n\n## Affected Files\n\n- `internal/cli/init_claude.go` - `generateOnboardingSnippet()` function\n- `internal/cli/onboard.go` - similar snippet\n\n## Suggested Fix\n\nUpdate the Quick Reference section to show:\n\n```bash\n# 1. Initialize stash\nstash init mydata --prefix dat-\n\n# 2. Define columns (names: letters, numbers, underscores only)\nstash column add company_name --primary\nstash column add status\nstash column add notes\n\n# 3. Add records\nstash add \"Acme Corp\" --set status=active\n```","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T01:46:29.61967684Z","created_by":"dev","updated_at":"2026-01-09T01:46:29.61967684Z","labels":["bug"]}
{"id":"st-85u","title":"Daemon process","description":"Commands: daemon start/stop/restart/status/logs. PID file management. Graceful shutdown. Log rotation (max 10MB). Stale PID detection.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:25.858090544Z","created_by":"dev","updated_at":"2026-01-08T20:28:53.318438257Z","closed_at":"2026-01-08T20:28:53.318438257Z","close_reason":"Closed","labels":["phase:6-daemon"],"dependencies":[{"issue_id":"st-85u","depends_on_id":"st-qhm","type":"blocks","created_at":"2026-01-08T19:42:51.76071058Z","created_by":"dev"}]}
{"id":"st-9w2","title":"Unit tests","description":"Tests for internal packages: model/, storage/, context/, output/. ID generation, hash calculation, JSONL parsing, SQLite operations.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:49.240114023Z","created_by":"dev","updated_at":"2026-01-08T21:17:11.395231172Z","closed_at":"2026-01-08T21:17:11.395231172Z","close_reason":"Closed","labels":["phase:7-testing"],"dependencies":[{"issue_id":"st-9w2","depends_on_id":"st-4a4","type":"blocks","created_at":"2026-01-08T19:42:58.030506831Z","created_by":"dev"}]}
{"id":"st-c56","title":"Edge case tests","description":"~113 edge case tests from tests.md: EC-ST-*, EC-COL-*, EC-REC-*, EC-QRY-*, EC-IMP-*, EC-SYN-*, EC-DMN-*. SQL injection, unicode, boundaries.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:51.220613605Z","created_by":"dev","updated_at":"2026-01-08T19:41:51.220613605Z","labels":["phase:7-testing"],"dependencies":[{"issue_id":"st-c56","depends_on_id":"st-yyh","type":"blocks","created_at":"2026-01-08T19:42:58.149581765Z","created_by":"dev"}]}
{"id":"st-gvm","title":"Context detection","description":"Actor resolution: --actor flag -\u003e $STASH_ACTOR -\u003e $USER -\u003e 'unknown'. Git branch detection via git rev-parse. Graceful fallback if not in git repo.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:42.651246068Z","created_by":"dev","updated_at":"2026-01-08T20:14:29.659467229Z","closed_at":"2026-01-08T20:14:29.659467229Z","close_reason":"Closed","labels":["phase:2-core-cli"],"dependencies":[{"issue_id":"st-gvm","depends_on_id":"st-3um","type":"blocks","created_at":"2026-01-08T19:42:37.984054455Z","created_by":"dev"}]}
{"id":"st-h2v","title":"Docs: stash onboarding missing column setup step","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T09:51:22.366846988Z","created_by":"dev","updated_at":"2026-01-09T11:44:04.290760481Z","closed_at":"2026-01-09T11:44:04.290760481Z","close_reason":"Added Getting Started section to stash --help and column requirement to stash add --help. Also notes underscore requirement for column names.","labels":["component:cli","context-gap"],"comments":[{"id":2,"issue_id":"st-h2v","author":"dev","text":"**Problem**\n\nWhen using stash for the first time, Claude Code attempted:\n```\nstash add \"Share Focus Limited\" --set status=pending --set industry=\"\" ...\n```\n\nGot error:\n```\nError: cannot add record - stash has no columns defined\nHint: use \\`stash column add \u003cname\u003e\\` to add a column first\n```\n\nClaude then had to discover:\n1. Columns must be defined before adding records\n2. Column names must use underscores (not hyphens)\n\n**Expected**\n\nOnboarding docs should clearly show the column-first workflow:\n1. Create stash\n2. Define columns\n3. Then add records\n\n**Affected Docs**\n- CLI help text (stash --help, stash add --help)\n- Any getting-started documentation\n\n**Acceptance Criteria**\n- [ ] Document column-first workflow in help text\n- [ ] Show example workflow in stash --help","created_at":"2026-01-09T09:51:33Z"}]}
{"id":"st-hyn","title":"Hierarchy support","description":"Support --parent flag in add. Command: children. Tree display in list --tree. Parent validation. Sequential child IDs (parent.1, parent.2).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:04.239748842Z","created_by":"dev","updated_at":"2026-01-08T21:17:11.211936442Z","closed_at":"2026-01-08T21:17:11.211936442Z","close_reason":"Closed","labels":["phase:4-advanced-records"],"dependencies":[{"issue_id":"st-hyn","depends_on_id":"st-1fl","type":"blocks","created_at":"2026-01-08T19:42:47.682692284Z","created_by":"dev"}]}
{"id":"st-k0y","title":"Query and history","description":"Commands: query (SELECT-only SQL), history (with --limit, --since, --by, --json). Block INSERT/UPDATE/DELETE in query command.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:53.160533753Z","created_by":"dev","updated_at":"2026-01-08T20:53:59.690061153Z","closed_at":"2026-01-08T20:53:59.690061153Z","close_reason":"Closed","labels":["phase:3-schema-query"],"dependencies":[{"issue_id":"st-k0y","depends_on_id":"st-1n7","type":"blocks","created_at":"2026-01-08T19:42:39.644125966Z","created_by":"dev"}]}
{"id":"st-mir","title":"Project scaffolding","description":"Go module init, directory structure (cmd/, internal/), Cobra root command with global flags (--json, --stash, --actor, --quiet, --verbose, --no-daemon)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:30.314873173Z","created_by":"dev","updated_at":"2026-01-08T20:01:56.982002308Z","closed_at":"2026-01-08T20:01:56.982002308Z","close_reason":"Scaffolding complete: Go module, directory structure, Cobra with global flags","labels":["phase:1-foundation"]}
{"id":"st-qhm","title":"Storage layer","description":"JSONL read/write (append-only). SQLite schema with dynamic columns. Sync algorithm. Indexes on parent_id, deleted_at, hash, branch, updated_at.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:31.978466271Z","created_by":"dev","updated_at":"2026-01-08T20:17:30.489516088Z","closed_at":"2026-01-08T20:17:30.489516088Z","close_reason":"Closed","labels":["phase:1-foundation"],"dependencies":[{"issue_id":"st-qhm","depends_on_id":"st-3um","type":"blocks","created_at":"2026-01-08T19:42:37.024259173Z","created_by":"dev"}]}
{"id":"st-sz0","title":"Doctor and repair","description":"Commands: doctor (with --fix, --deep, --json, --yes), repair (with --dry-run, --source, --clean-orphans, --rehash). Health checks and auto-fix.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:17.581882414Z","created_by":"dev","updated_at":"2026-01-08T20:42:38.674332601Z","closed_at":"2026-01-08T20:42:38.674332601Z","close_reason":"Closed","labels":["phase:5-integration"],"dependencies":[{"issue_id":"st-sz0","depends_on_id":"st-6ul","type":"blocks","created_at":"2026-01-08T19:42:49.263212871Z","created_by":"dev"}]}
{"id":"st-ta2","title":"File watcher","description":"fsnotify integration. Watch .stash/*/records.jsonl and config.json. Debounce rapid changes (100ms). Auto-sync to SQLite on file changes.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:26.701814956Z","created_by":"dev","updated_at":"2026-01-08T21:17:11.332502313Z","closed_at":"2026-01-08T21:17:11.332502313Z","close_reason":"Closed","labels":["phase:6-daemon"],"dependencies":[{"issue_id":"st-ta2","depends_on_id":"st-85u","type":"blocks","created_at":"2026-01-08T19:42:51.817667937Z","created_by":"dev"}]}
{"id":"st-tne","title":"Column management","description":"Commands: column add (with --desc), column list (with stats), column describe, column rename, column drop. Case-insensitive matching. Reserved name validation.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:51.040409241Z","created_by":"dev","updated_at":"2026-01-08T20:45:27.439824236Z","closed_at":"2026-01-08T20:45:27.439824236Z","close_reason":"Closed","labels":["phase:3-schema-query"],"dependencies":[{"issue_id":"st-tne","depends_on_id":"st-w3r","type":"blocks","created_at":"2026-01-08T19:42:39.527624796Z","created_by":"dev"}],"comments":[{"id":1,"issue_id":"st-tne","author":"dev","text":"Implemented UC-COL-001 (Add Column), UC-COL-002 (List Columns), UC-COL-003 (Describe Column). All acceptance criteria tests pass. Remaining: UC-COL-004 (Rename Column), UC-COL-005 (Drop Column).","created_at":"2026-01-08T20:39:30Z"}]}
{"id":"st-w3r","title":"Stash management commands","description":"Commands: init, drop, info, onboard, prime. Create .stash/ directory structure. config.json with schema. Daemon auto-start on init.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:40:41.421406093Z","created_by":"dev","updated_at":"2026-01-08T20:33:53.343477288Z","closed_at":"2026-01-08T20:33:53.343477288Z","close_reason":"Closed","labels":["phase:2-core-cli"],"dependencies":[{"issue_id":"st-w3r","depends_on_id":"st-qhm","type":"blocks","created_at":"2026-01-08T19:42:37.857174305Z","created_by":"dev"}]}
{"id":"st-yyh","title":"UCDD integration tests","description":"Tests for all 28 use cases: UC-ST-*, UC-REC-*, UC-COL-*, UC-QRY-*, UC-IMP-*, UC-SYN-*, UC-DMN-*. One test function per use case with AC subtests.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:41:50.140585597Z","created_by":"dev","updated_at":"2026-01-08T21:17:11.455159931Z","closed_at":"2026-01-08T21:17:11.455159931Z","close_reason":"Closed","labels":["phase:7-testing"],"dependencies":[{"issue_id":"st-yyh","depends_on_id":"st-4a4","type":"blocks","created_at":"2026-01-08T19:42:58.087907556Z","created_by":"dev"}]}
